<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Code Interpreter Control - Test Harness</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            padding: 20px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .demo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .demo-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .demo-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }

        .demo-card h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.5rem;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .demo-card .description {
            color: #666;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .config-section {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .config-section h3 {
            color: #764ba2;
            font-size: 1rem;
            margin-bottom: 10px;
        }

        .input-group {
            margin-bottom: 12px;
        }

        .input-group label {
            display: block;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }

        .input-group input,
        .input-group select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 0.95rem;
            transition: border-color 0.3s ease;
        }

        .input-group input:focus,
        .input-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .control-container {
            background: #ffffff;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            min-height: 400px;
            padding: 20px;
            margin-top: 15px;
            position: relative;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        button {
            flex: 1;
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .status-indicator {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-top: 10px;
        }

        .status-ready {
            background: #d4edda;
            color: #155724;
        }

        .status-loading {
            background: #fff3cd;
            color: #856404;
        }

        .status-error {
            background: #f8d7da;
            color: #721c24;
        }

        .info-panel {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 20px;
        }

        .info-panel h2 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .info-panel ul {
            list-style: none;
            padding-left: 0;
        }

        .info-panel li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
            line-height: 1.6;
        }

        .info-panel li:before {
            content: "✓";
            position: absolute;
            left: 0;
            color: #667eea;
            font-weight: bold;
        }

        .code-block {
            background: #2d3748;
            color: #68d391;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
            margin-top: 10px;
        }

        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-left: 10px;
        }

        .badge-new {
            background: #ffeaa7;
            color: #6c5ce7;
        }

        .badge-ai {
            background: #74b9ff;
            color: #0984e3;
        }

        @media (max-width: 768px) {
            .demo-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🤖 Code Interpreter Control <span class="badge badge-ai">AI Powered</span></h1>
            <p>Interactive testing environment for PCF Code Interpreter Control</p>
        </div>

        <div class="info-panel">
            <h2>📋 About This Control</h2>
            <p style="margin-bottom: 15px; color: #666;">
                The Code Interpreter Control integrates with AI-powered prompts to display interactive visualizations, 
                charts, and document previews. It can handle HTML/JavaScript outputs and render file previews for 
                PDF, Word, PowerPoint, and Excel documents.
            </p>
            <ul>
                <li>Execute code interpreter-enabled AI prompts dynamically</li>
                <li>Display interactive HTML/JavaScript data visualizations</li>
                <li>Preview and download generated documents (PDF, Word, Excel, PowerPoint)</li>
                <li>Real-time error handling and validation</li>
                <li>Seamless integration with Dataverse AI capabilities</li>
            </ul>
        </div>

        <div class="demo-grid">
            <!-- Demo 1: Interactive Chart Generation -->
            <div class="demo-card">
                <h2>📊 Interactive Chart Demo <span class="badge badge-new">New</span></h2>
                <p class="description">
                    This demo shows how the control can execute an AI prompt that generates interactive 
                    HTML/JavaScript visualizations, such as charts comparing data across records.
                </p>

                <div class="config-section">
                    <h3>Configuration</h3>
                    <div class="input-group">
                        <label for="chart-model-id">Model ID (AI Prompt):</label>
                        <input 
                            type="text" 
                            id="chart-model-id" 
                            placeholder="6ed18606-78da-4903-a868-73c7b462b336"
                            value="6ed18606-78da-4903-a868-73c7b462b336"
                        />
                    </div>
                    <div class="input-group">
                        <label for="chart-record-id">Record ID:</label>
                        <input 
                            type="text" 
                            id="chart-record-id" 
                            placeholder="Enter a record GUID"
                            value="sample-record-001"
                        />
                    </div>
                    <div class="input-group">
                        <label for="chart-type">Chart Type:</label>
                        <select id="chart-type">
                            <option value="bar">Bar Chart</option>
                            <option value="line">Line Chart</option>
                            <option value="pie">Pie Chart</option>
                            <option value="comparison">Comparison Chart</option>
                        </select>
                    </div>
                </div>

                <div class="control-container" id="chart-container">
                    <div style="text-align: center; padding: 100px 20px; color: #999;">
                        <p>🎨 Click "Load Chart" to see interactive visualization</p>
                        <p style="font-size: 0.9rem; margin-top: 10px;">This will execute the AI prompt and display the result</p>
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn-primary" onclick="loadChart()">Load Chart</button>
                    <button class="btn-secondary" onclick="clearChart()">Clear</button>
                </div>
                <span class="status-indicator status-ready" id="chart-status">Ready</span>
            </div>

            <!-- Demo 2: Document Generation & Preview -->
            <div class="demo-card">
                <h2>📄 Document Preview Demo</h2>
                <p class="description">
                    This demo demonstrates document generation and preview capabilities. The control can 
                    display PDF documents inline and provide download options for Word, Excel, and PowerPoint files.
                </p>

                <div class="config-section">
                    <h3>Configuration</h3>
                    <div class="input-group">
                        <label for="doc-model-id">Model ID (AI Prompt):</label>
                        <input 
                            type="text" 
                            id="doc-model-id" 
                            placeholder="b412c9a3-1b4f-45c4-956d-33bd4412be33"
                            value="b412c9a3-1b4f-45c4-956d-33bd4412be33"
                        />
                    </div>
                    <div class="input-group">
                        <label for="doc-record-id">Record ID:</label>
                        <input 
                            type="text" 
                            id="doc-record-id" 
                            placeholder="Enter a record GUID"
                            value="sample-record-002"
                        />
                    </div>
                    <div class="input-group">
                        <label for="doc-type">Document Type:</label>
                        <select id="doc-type">
                            <option value="pdf">PDF Document</option>
                            <option value="word">Word Document (.docx)</option>
                            <option value="excel">Excel Spreadsheet (.xlsx)</option>
                            <option value="powerpoint">PowerPoint (.pptx)</option>
                        </select>
                    </div>
                </div>

                <div class="control-container" id="doc-container">
                    <div style="text-align: center; padding: 100px 20px; color: #999;">
                        <p>📝 Click "Generate Document" to create and preview</p>
                        <p style="font-size: 0.9rem; margin-top: 10px;">AI will generate a document based on the record data</p>
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn-primary" onclick="loadDocument()">Generate Document</button>
                    <button class="btn-secondary" onclick="clearDocument()">Clear</button>
                </div>
                <span class="status-indicator status-ready" id="doc-status">Ready</span>
            </div>
        </div>

        <!-- Technical Details Section -->
        <div class="info-panel">
            <h2>🔧 Technical Implementation</h2>
            <p style="margin-bottom: 15px; color: #666;">
                This test harness demonstrates the control running in a simulated environment. 
                In production, the control would be embedded in a model-driven app form.
            </p>
            
            <div class="code-block">
// Example: Adding the control to a form
&lt;PCFCodeInterpreter
    modelId="your-ai-model-guid"
    entityId="your-record-guid"
/&gt;
            </div>

            <h3 style="margin-top: 20px; margin-bottom: 10px; color: #764ba2;">Key Features:</h3>
            <ul>
                <li><strong>Dynamic AI Integration:</strong> Connects to Code Interpreter-enabled prompts</li>
                <li><strong>Multiple Output Formats:</strong> HTML, JavaScript, PDF, Word, Excel, PowerPoint</li>
                <li><strong>Error Handling:</strong> Comprehensive validation and user-friendly error messages</li>
                <li><strong>Real-time Preview:</strong> Instant rendering of AI-generated content</li>
                <li><strong>Download Support:</strong> Direct download links for all document types</li>
            </ul>

            <h3 style="margin-top: 20px; margin-bottom: 10px; color: #764ba2;">Dependencies:</h3>
            <div class="code-block">
"mammoth": "^1.9.1"  // For Word document preview
"xlsx": "^0.18.5"     // For Excel spreadsheet handling
            </div>
        </div>
    </div>

    <script>
        // Simulated PCF Control Implementation
        function updateStatus(elementId, status, message) {
            const statusElement = document.getElementById(elementId);
            statusElement.className = `status-indicator status-${status}`;
            statusElement.textContent = message;
        }

        function loadChart() {
            const modelId = document.getElementById('chart-model-id').value;
            const recordId = document.getElementById('chart-record-id').value;
            const chartType = document.getElementById('chart-type').value;
            const container = document.getElementById('chart-container');
            
            updateStatus('chart-status', 'loading', 'Loading...');
            
            // Simulate API call delay
            setTimeout(() => {
                // Generate a sample chart based on type
                let chartHtml = generateSampleChart(chartType, recordId);
                container.innerHTML = chartHtml;
                updateStatus('chart-status', 'ready', 'Chart Loaded ✓');
            }, 1500);
        }

        function clearChart() {
            const container = document.getElementById('chart-container');
            container.innerHTML = `
                <div style="text-align: center; padding: 100px 20px; color: #999;">
                    <p>🎨 Click "Load Chart" to see interactive visualization</p>
                    <p style="font-size: 0.9rem; margin-top: 10px;">This will execute the AI prompt and display the result</p>
                </div>
            `;
            updateStatus('chart-status', 'ready', 'Ready');
        }

        function loadDocument() {
            const modelId = document.getElementById('doc-model-id').value;
            const recordId = document.getElementById('doc-record-id').value;
            const docType = document.getElementById('doc-type').value;
            const container = document.getElementById('doc-container');
            
            updateStatus('doc-status', 'loading', 'Generating...');
            
            // Simulate API call delay
            setTimeout(() => {
                let docHtml = generateSampleDocument(docType, recordId);
                container.innerHTML = docHtml;
                updateStatus('doc-status', 'ready', 'Document Ready ✓');
            }, 2000);
        }

        function clearDocument() {
            const container = document.getElementById('doc-container');
            container.innerHTML = `
                <div style="text-align: center; padding: 100px 20px; color: #999;">
                    <p>📝 Click "Generate Document" to create and preview</p>
                    <p style="font-size: 0.9rem; margin-top: 10px;">AI will generate a document based on the record data</p>
                </div>
            `;
            updateStatus('doc-status', 'ready', 'Ready');
        }

        function generateSampleChart(chartType, recordId) {
            const chartData = {
                'bar': generateBarChart(recordId),
                'line': generateLineChart(recordId),
                'pie': generatePieChart(recordId),
                'comparison': generateComparisonChart(recordId)
            };
            
            return chartData[chartType] || chartData['bar'];
        }

        function generateBarChart(recordId) {
            return `
                <div style="padding: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 20px;">📊 Sales Performance - Bar Chart</h3>
                    <p style="color: #666; margin-bottom: 20px;">Record: ${recordId}</p>
                    <svg width="100%" height="300" style="border: 1px solid #e0e0e0; border-radius: 8px; background: #f8f9fa;">
                        <rect x="50" y="50" width="80" height="200" fill="#667eea" opacity="0.8"/>
                        <text x="90" y="270" text-anchor="middle" font-size="12">Q1</text>
                        <text x="90" y="40" text-anchor="middle" font-size="12" fill="#667eea">$45K</text>
                        
                        <rect x="150" y="80" width="80" height="170" fill="#764ba2" opacity="0.8"/>
                        <text x="190" y="270" text-anchor="middle" font-size="12">Q2</text>
                        <text x="190" y="70" text-anchor="middle" font-size="12" fill="#764ba2">$38K</text>
                        
                        <rect x="250" y="30" width="80" height="220" fill="#667eea" opacity="0.8"/>
                        <text x="290" y="270" text-anchor="middle" font-size="12">Q3</text>
                        <text x="290" y="20" text-anchor="middle" font-size="12" fill="#667eea">$52K</text>
                        
                        <rect x="350" y="60" width="80" height="190" fill="#764ba2" opacity="0.8"/>
                        <text x="390" y="270" text-anchor="middle" font-size="12">Q4</text>
                        <text x="390" y="50" text-anchor="middle" font-size="12" fill="#764ba2">$42K</text>
                    </svg>
                    <p style="margin-top: 20px; color: #666; font-size: 0.9rem;">
                        <em>This interactive chart was generated by the Code Interpreter AI based on record data.</em>
                    </p>
                </div>
            `;
        }

        function generateLineChart(recordId) {
            return `
                <div style="padding: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 20px;">📈 Growth Trend - Line Chart</h3>
                    <p style="color: #666; margin-bottom: 20px;">Record: ${recordId}</p>
                    <svg width="100%" height="300" style="border: 1px solid #e0e0e0; border-radius: 8px; background: #f8f9fa;">
                        <polyline points="50,200 150,150 250,100 350,120 450,80" 
                                  fill="none" stroke="#667eea" stroke-width="3"/>
                        <circle cx="50" cy="200" r="5" fill="#667eea"/>
                        <circle cx="150" cy="150" r="5" fill="#667eea"/>
                        <circle cx="250" cy="100" r="5" fill="#667eea"/>
                        <circle cx="350" cy="120" r="5" fill="#667eea"/>
                        <circle cx="450" cy="80" r="5" fill="#667eea"/>
                        
                        <line x1="50" y1="260" x2="450" y2="260" stroke="#ccc" stroke-width="1"/>
                        <line x1="50" y1="50" x2="50" y2="260" stroke="#ccc" stroke-width="1"/>
                    </svg>
                    <p style="margin-top: 20px; color: #666; font-size: 0.9rem;">
                        <em>AI-generated trend analysis showing monthly performance metrics.</em>
                    </p>
                </div>
            `;
        }

        function generatePieChart(recordId) {
            return `
                <div style="padding: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 20px;">🥧 Market Share - Pie Chart</h3>
                    <p style="color: #666; margin-bottom: 20px;">Record: ${recordId}</p>
                    <svg width="100%" height="300" viewBox="0 0 400 300" style="border: 1px solid #e0e0e0; border-radius: 8px; background: #f8f9fa;">
                        <circle cx="200" cy="150" r="100" fill="#667eea" opacity="0.8"/>
                        <path d="M 200 150 L 200 50 A 100 100 0 0 1 280 200 Z" fill="#764ba2" opacity="0.8"/>
                        <path d="M 200 150 L 280 200 A 100 100 0 0 1 150 220 Z" fill="#68d391" opacity="0.8"/>
                        
                        <text x="150" y="120" font-size="14" fill="white">45%</text>
                        <text x="250" y="150" font-size="14" fill="white">30%</text>
                        <text x="180" y="200" font-size="14" fill="white">25%</text>
                    </svg>
                    <div style="margin-top: 20px;">
                        <span style="color: #667eea;">● Product A (45%)</span> &nbsp;
                        <span style="color: #764ba2;">● Product B (30%)</span> &nbsp;
                        <span style="color: #68d391;">● Product C (25%)</span>
                    </div>
                </div>
            `;
        }

        function generateComparisonChart(recordId) {
            return `
                <div style="padding: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 20px;">⚖️ Credit Limit Comparison</h3>
                    <p style="color: #666; margin-bottom: 20px;">Record: ${recordId} - Comparing across multiple accounts</p>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-top: 20px;">
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; text-align: center; border: 2px solid #667eea;">
                            <div style="font-size: 2rem; color: #667eea; font-weight: bold;">$50K</div>
                            <div style="color: #666; margin-top: 10px;">Account A</div>
                            <div style="margin-top: 10px; height: 100px; background: linear-gradient(to top, #667eea, transparent); border-radius: 4px;"></div>
                        </div>
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; text-align: center; border: 2px solid #764ba2;">
                            <div style="font-size: 2rem; color: #764ba2; font-weight: bold;">$75K</div>
                            <div style="color: #666; margin-top: 10px;">Account B</div>
                            <div style="margin-top: 10px; height: 150px; background: linear-gradient(to top, #764ba2, transparent); border-radius: 4px;"></div>
                        </div>
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; text-align: center; border: 2px solid #68d391;">
                            <div style="font-size: 2rem; color: #68d391; font-weight: bold;">$35K</div>
                            <div style="color: #666; margin-top: 10px;">Account C</div>
                            <div style="margin-top: 10px; height: 70px; background: linear-gradient(to top, #68d391, transparent); border-radius: 4px;"></div>
                        </div>
                    </div>
                    <p style="margin-top: 20px; color: #666; font-size: 0.9rem;">
                        <em>📊 This comparison shows credit limits across related account records.</em>
                    </p>
                </div>
            `;
        }

        function generateSampleDocument(docType, recordId) {
            const docTemplates = {
                'pdf': generatePdfPreview(recordId),
                'word': generateWordPreview(recordId),
                'excel': generateExcelPreview(recordId),
                'powerpoint': generatePowerPointPreview(recordId)
            };
            
            return docTemplates[docType] || docTemplates['pdf'];
        }

        function generatePdfPreview(recordId) {
            return `
                <div style="padding: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 20px;">📕 PDF Document Preview</h3>
                    <p style="color: #666; margin-bottom: 20px;">Record: ${recordId}</p>
                    <div style="background: white; border: 2px solid #e0e0e0; border-radius: 8px; padding: 30px; min-height: 300px;">
                        <div style="text-align: center; border-bottom: 2px solid #667eea; padding-bottom: 20px; margin-bottom: 20px;">
                            <h1 style="color: #667eea;">Sales Proposal</h1>
                            <p style="color: #666;">Generated by AI Code Interpreter</p>
                        </div>
                        <div style="line-height: 1.8;">
                            <h2 style="color: #764ba2; margin-top: 20px;">Executive Summary</h2>
                            <p style="color: #333;">
                                This document presents a comprehensive sales proposal for record ${recordId}. 
                                The analysis includes market trends, competitive positioning, and strategic recommendations.
                            </p>
                            
                            <h2 style="color: #764ba2; margin-top: 20px;">Key Findings</h2>
                            <ul style="color: #333;">
                                <li>Market opportunity: $2.5M annual revenue potential</li>
                                <li>Competitive advantage: 35% faster implementation</li>
                                <li>ROI projection: 18 months to break-even</li>
                            </ul>
                            
                            <h2 style="color: #764ba2; margin-top: 20px;">Recommendations</h2>
                            <p style="color: #333;">
                                Based on our analysis, we recommend proceeding with Phase 1 implementation 
                                in Q1 2025, followed by full deployment in Q3 2025.
                            </p>
                        </div>
                    </div>
                    <button style="margin-top: 15px; padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer;" 
                            onclick="alert('In production, this would download the PDF file.')">
                        📥 Download PDF
                    </button>
                </div>
            `;
        }

        function generateWordPreview(recordId) {
            return `
                <div style="padding: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 20px;">📘 Word Document</h3>
                    <p style="color: #666; margin-bottom: 20px;">Record: ${recordId}</p>
                    <div style="background: white; border: 2px solid #2b579a; border-radius: 8px; padding: 30px; min-height: 300px;">
                        <div style="font-family: 'Calibri', sans-serif;">
                            <h1 style="color: #2b579a; font-size: 24pt;">Business Report</h1>
                            <p style="color: #666; margin-bottom: 30px;">Document generated: ${new Date().toLocaleDateString()}</p>
                            
                            <p style="line-height: 1.8; margin-bottom: 15px;">
                                This is a dynamically generated Word document created by the Code Interpreter 
                                AI based on the data from record <strong>${recordId}</strong>.
                            </p>
                            
                            <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
                                <tr style="background: #2b579a; color: white;">
                                    <th style="padding: 10px; border: 1px solid #ccc;">Metric</th>
                                    <th style="padding: 10px; border: 1px solid #ccc;">Value</th>
                                </tr>
                                <tr>
                                    <td style="padding: 10px; border: 1px solid #ccc;">Revenue</td>
                                    <td style="padding: 10px; border: 1px solid #ccc;">$125,000</td>
                                </tr>
                                <tr style="background: #f8f9fa;">
                                    <td style="padding: 10px; border: 1px solid #ccc;">Growth Rate</td>
                                    <td style="padding: 10px; border: 1px solid #ccc;">+15%</td>
                                </tr>
                                <tr>
                                    <td style="padding: 10px; border: 1px solid #ccc;">Status</td>
                                    <td style="padding: 10px; border: 1px solid #ccc;">Active</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <button style="margin-top: 15px; padding: 10px 20px; background: #2b579a; color: white; border: none; border-radius: 6px; cursor: pointer;" 
                            onclick="alert('In production, this would download the DOCX file.')">
                        📥 Download Word Document
                    </button>
                    <p style="margin-top: 10px; color: #666; font-size: 0.9rem;">
                        <em>Word documents are rendered using the mammoth library for preview.</em>
                    </p>
                </div>
            `;
        }

        function generateExcelPreview(recordId) {
            return `
                <div style="padding: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 20px;">📗 Excel Spreadsheet</h3>
                    <p style="color: #666; margin-bottom: 20px;">Record: ${recordId}</p>
                    <div style="background: white; border: 2px solid #217346; border-radius: 8px; padding: 20px; overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; font-family: 'Calibri', sans-serif;">
                            <thead>
                                <tr style="background: #217346; color: white;">
                                    <th style="padding: 12px; border: 1px solid #ccc; text-align: left;">Month</th>
                                    <th style="padding: 12px; border: 1px solid #ccc; text-align: right;">Sales</th>
                                    <th style="padding: 12px; border: 1px solid #ccc; text-align: right;">Expenses</th>
                                    <th style="padding: 12px; border: 1px solid #ccc; text-align: right;">Profit</th>
                                    <th style="padding: 12px; border: 1px solid #ccc; text-align: center;">Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="padding: 10px; border: 1px solid #ccc;">January</td>
                                    <td style="padding: 10px; border: 1px solid #ccc; text-align: right;">$45,000</td>
                                    <td style="padding: 10px; border: 1px solid #ccc; text-align: right;">$32,000</td>
                                    <td style="padding: 10px; border: 1px solid #ccc; text-align: right; color: #217346; font-weight: bold;">$13,000</td>
                                    <td style="padding: 10px; border: 1px solid #ccc; text-align: center;">✓</td>
                                </tr>
                                <tr style="background: #f8f9fa;">
                                    <td style="padding: 10px; border: 1px solid #ccc;">February</td>
                                    <td style="padding: 10px; border: 1px solid #ccc; text-align: right;">$52,000</td>
                                    <td style="padding: 10px; border: 1px solid #ccc; text-align: right;">$35,000</td>
                                    <td style="padding: 10px; border: 1px solid #ccc; text-align: right; color: #217346; font-weight: bold;">$17,000</td>
                                    <td style="padding: 10px; border: 1px solid #ccc; text-align: center;">✓</td>
                                </tr>
                                <tr>
                                    <td style="padding: 10px; border: 1px solid #ccc;">March</td>
                                    <td style="padding: 10px; border: 1px solid #ccc; text-align: right;">$48,000</td>
                                    <td style="padding: 10px; border: 1px solid #ccc; text-align: right;">$31,000</td>
                                    <td style="padding: 10px; border: 1px solid #ccc; text-align: right; color: #217346; font-weight: bold;">$17,000</td>
                                    <td style="padding: 10px; border: 1px solid #ccc; text-align: center;">✓</td>
                                </tr>
                                <tr style="background: #217346; color: white; font-weight: bold;">
                                    <td style="padding: 10px; border: 1px solid #ccc;">TOTAL</td>
                                    <td style="padding: 10px; border: 1px solid #ccc; text-align: right;">$145,000</td>
                                    <td style="padding: 10px; border: 1px solid #ccc; text-align: right;">$98,000</td>
                                    <td style="padding: 10px; border: 1px solid #ccc; text-align: right;">$47,000</td>
                                    <td style="padding: 10px; border: 1px solid #ccc; text-align: center;">—</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <button style="margin-top: 15px; padding: 10px 20px; background: #217346; color: white; border: none; border-radius: 6px; cursor: pointer;" 
                            onclick="alert('In production, this would download the XLSX file.')">
                        📥 Download Excel File
                    </button>
                    <p style="margin-top: 10px; color: #666; font-size: 0.9rem;">
                        <em>Excel files are parsed using the xlsx library (SheetJS).</em>
                    </p>
                </div>
            `;
        }

        function generatePowerPointPreview(recordId) {
            return `
                <div style="padding: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 20px;">📙 PowerPoint Presentation</h3>
                    <p style="color: #666; margin-bottom: 20px;">Record: ${recordId}</p>
                    
                    <!-- Slide 1 -->
                    <div style="background: white; border: 2px solid #d24726; border-radius: 8px; padding: 40px; margin-bottom: 15px; min-height: 250px; position: relative;">
                        <div style="text-align: center; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 80%;">
                            <h1 style="color: #d24726; font-size: 2.5rem; margin-bottom: 20px;">Q4 Performance Review</h1>
                            <p style="color: #666; font-size: 1.2rem;">Data Analysis for Record ${recordId}</p>
                            <p style="color: #999; margin-top: 30px;">Slide 1 of 3</p>
                        </div>
                    </div>
                    
                    <!-- Slide 2 -->
                    <div style="background: white; border: 2px solid #d24726; border-radius: 8px; padding: 40px; margin-bottom: 15px; min-height: 250px;">
                        <h2 style="color: #d24726; margin-bottom: 20px;">Key Metrics</h2>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                            <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 2rem; color: #d24726; font-weight: bold;">156%</div>
                                <div style="color: #666; margin-top: 5px;">Growth Rate</div>
                            </div>
                            <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 2rem; color: #217346; font-weight: bold;">$2.4M</div>
                                <div style="color: #666; margin-top: 5px;">Revenue</div>
                            </div>
                        </div>
                        <p style="color: #999; text-align: right; margin-top: 20px;">Slide 2 of 3</p>
                    </div>
                    
                    <!-- Slide 3 -->
                    <div style="background: white; border: 2px solid #d24726; border-radius: 8px; padding: 40px; min-height: 250px;">
                        <h2 style="color: #d24726; margin-bottom: 20px;">Next Steps</h2>
                        <ul style="color: #333; font-size: 1.1rem; line-height: 2;">
                            <li>Expand market reach in Q1 2025</li>
                            <li>Launch new product line</li>
                            <li>Increase team capacity by 25%</li>
                            <li>Implement AI-driven analytics</li>
                        </ul>
                        <p style="color: #999; text-align: right; margin-top: 20px;">Slide 3 of 3</p>
                    </div>
                    
                    <button style="margin-top: 15px; padding: 10px 20px; background: #d24726; color: white; border: none; border-radius: 6px; cursor: pointer;" 
                            onclick="alert('In production, this would download the PPTX file.')">
                        📥 Download PowerPoint
                    </button>
                    <p style="margin-top: 10px; color: #666; font-size: 0.9rem;">
                        <em>PowerPoint files provide download links in the actual control.</em>
                    </p>
                </div>
            `;
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            console.log('🚀 Code Interpreter Control Test Harness loaded');
            console.log('📋 Ready to demonstrate AI-powered document and visualization generation');
        });
    </script>
</body>
</html>
